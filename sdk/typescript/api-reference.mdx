---
title: API Reference
description: TypeScript SDK API reference
---



## Raindrop

### Constructor

```typescript
new Raindrop(config: RaindropConfig)
```

| Option | Type | Required | Description |
|--------|------|----------|-------------|
| `apiKey` | `string` | Yes | Your Raindrop API key (or use `writeKey` for backwards compat) |
| `baseUrl` | `string` | No | API base URL (default: `https://api.raindrop.ai`) |
| `debug` | `boolean` | No | Enable debug logging |
| `disabled` | `boolean` | No | Disable all tracking |
| `flushInterval` | `number` | No | Ms between auto-flushes (default: 1000) |
| `maxQueueSize` | `number` | No | Flush at this queue size (default: 100) |
| `maxRetries` | `number` | No | Retry failed requests (default: 3) |
| `plugins` | `RaindropPlugin[]` | No | Array of plugins (PII, OTEL, custom) |
| `redactPii` | `boolean` | No | Shorthand for adding PII plugin |

### Methods

#### `wrap(client)`

Wrap an AI client for automatic tracing.

```typescript
const openai = raindrop.wrap(new OpenAI());
```

Returns the same client type with tracing enabled.

---

#### `identify(userId, traits?)`

Set the current user for all subsequent calls.

```typescript
raindrop.identify('user_123', {
  name: 'Jane Doe',
  email: 'jane@example.com',
  plan: 'pro',
});
```

---

#### `feedback(traceId, options)`

Send feedback for a specific trace.

```typescript
await raindrop.feedback(traceId, {
  type: 'thumbs_up',
  comment: 'Great answer!',
});
```

---

#### `withInteraction(options, fn)`

Execute a function within an interaction context.

```typescript
await raindrop.withInteraction(
  { event: 'rag_query', userId: 'user_123' },
  async (ctx) => {
    // All traced calls are auto-linked
    ctx.output = 'Final result';
  }
);
```

---

#### `begin(options)`

Start a new interaction with manual control.

```typescript
const interaction = raindrop.begin({
  event: 'chat',
  userId: 'user_123',
  input: 'Hello',
});
```

Returns an `Interaction` object.

---

#### `resumeInteraction(eventId)`

Resume an existing interaction by ID.

```typescript
const interaction = raindrop.resumeInteraction('evt_123');
```

---

#### `wrapTool(name, fn)`

Wrap a function as a traced tool.

```typescript
const searchDocs = raindrop.wrapTool('search_docs', async (query) => {
  return await vectorDB.search(query);
});
```

---

#### `getLastTraceId()`

Get the most recent trace ID.

```typescript
const traceId = raindrop.getLastTraceId();
```

---

#### `trackSignal(options)`

Send a custom signal with full control over sentiment and type.

```typescript
await raindrop.trackSignal({
  eventId: 'trace_123',
  name: 'quality_review',
  sentiment: 'POSITIVE',   // 'POSITIVE' | 'NEGATIVE'
  type: 'feedback',        // 'default' | 'feedback' | 'edit'
  comment: 'Detailed feedback',
  after: 'Corrected text', // For edit signals
  properties: { ... },
});
```

---

#### `flush()`

Manually flush all pending events without closing.

```typescript
await raindrop.flush();
```

---

#### `close()`

Flush all pending events and close the transport.

```typescript
await raindrop.close();
```

---

#### `startSpan(name, options?)`

Create a manual span for tracing operations.

```typescript
const span = raindrop.startSpan('process_data', { kind: 'task' });
try {
  const result = await process(data);
  span.setOutput(result);
} finally {
  span.end();
}
```

---

## Interaction

Returned by `begin()` and `resumeInteraction()`.

### Properties

| Property | Type | Description |
|----------|------|-------------|
| `id` | `string` | The interaction/event ID |
| `output` | `string \| undefined` | Get/set the output |

### Methods

#### `setProperty(key, value)`

Set a single property.

```typescript
interaction.setProperty('stage', 'completed');
```

---

#### `setProperties(props)`

Set multiple properties.

```typescript
interaction.setProperties({ tokens: 150, cached: true });
```

---

#### `addAttachments(attachments)`

Add attachments to the interaction.

```typescript
interaction.addAttachments([
  { type: 'text', name: 'context', value: '...', role: 'input' }
]);
```

---

#### `setInput(input)`

Set the input text.

```typescript
interaction.setInput('User query');
```

---

#### `finish(options?)`

Finish and send the interaction.

```typescript
interaction.finish({
  output: 'Final response',
  properties: { ... },
});
```

---

#### `withTool(options, fn)`

Execute and trace a tool inline within the interaction.

```typescript
const results = await interaction.withTool(
  { name: 'search_docs', properties: { source: 'pinecone' } },
  async () => {
    return await vectorDB.search(query);
  }
);
```

Automatically adds a span to the interaction with timing and result.
