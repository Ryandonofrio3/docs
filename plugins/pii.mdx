---
title: PII Redaction
description: Automatically redact sensitive data before it leaves your app
---

# PII Redaction Plugin

The PII plugin redacts personally identifiable information from your traces before they're sent to Raindrop. This ensures sensitive data like emails, phone numbers, and credit cards never leave your infrastructure.

## Quick Start

<Tabs>
  <Tab title="TypeScript">
    ```typescript
    import { Raindrop } from 'rd-mini';

    // Option 1: Use convenience flag
    const raindrop = new Raindrop({
      apiKey: process.env.RAINDROP_API_KEY,
      redactPii: true,
    });

    // Option 2: Use plugin directly for more control
    import { createPiiPlugin } from 'rd-mini/plugins/pii';

    const raindrop = new Raindrop({
      apiKey: process.env.RAINDROP_API_KEY,
      plugins: [
        createPiiPlugin({
          patterns: ['email', 'phone', 'ssn'],
        }),
      ],
    });
    ```
  </Tab>
  <Tab title="Python">
    ```python
    import os
    from rd_mini import Raindrop

    # Option 1: Use convenience flag
    raindrop = Raindrop(
        api_key=os.environ["RAINDROP_API_KEY"],
        redact_pii=True,
    )

    # Option 2: Use plugin directly for more control
    from rd_mini.plugins import create_pii_plugin

    raindrop = Raindrop(
        api_key=os.environ["RAINDROP_API_KEY"],
        plugins=[
            create_pii_plugin(patterns=["email", "phone", "ssn"]),
        ],
    )
    ```
  </Tab>
</Tabs>

## What Gets Redacted

The plugin redacts the following by default:

| Pattern | Example | Redacted As |
|---------|---------|-------------|
| `email` | `user@example.com` | `<REDACTED>` |
| `phone` | `(555) 123-4567` | `<REDACTED>` |
| `ssn` | `123-45-6789` | `<REDACTED>` |
| `creditCard` | `4111-1111-1111-1111` | `<REDACTED>` |
| `credentials` | `api_key: sk-xxx` | `<REDACTED>` |
| `address` | `123 Main Street` | `<REDACTED>` |
| `password` | `password: secret` | `<REDACTED>` |

## Configuration Options

<Tabs>
  <Tab title="TypeScript">
    ```typescript
    createPiiPlugin({
      // Which patterns to use (default: all)
      patterns: ['email', 'phone', 'ssn', 'creditCard', 'credentials', 'address', 'password'],

      // Custom regex patterns
      customPatterns: [/INTERNAL-\d+/g],

      // Strings to never redact
      allowList: ['support@company.com'],

      // Replacement text (default: <REDACTED>)
      replacement: '[REMOVED]',

      // Redact names using well-known names list and greeting/closing context (default: false)
      redactNames: true,

      // Use specific tokens like <REDACTED_EMAIL> instead of generic <REDACTED> (default: false)
      specificTokens: true,
    });
    ```
  </Tab>
  <Tab title="Python">
    ```python
    import re

    create_pii_plugin(
        # Which patterns to use (default: all)
        patterns=["email", "phone", "ssn", "credit_card", "credentials", "address", "password"],

        # Custom regex patterns
        custom_patterns=[re.compile(r"INTERNAL-\d+")],

        # Strings to never redact
        allow_list=["support@company.com"],

        # Replacement text (default: <REDACTED>)
        replacement="[REMOVED]",

        # Redact names using well-known names list and greeting/closing context (default: False)
        redact_names=True,

        # Use specific tokens like <REDACTED_EMAIL> instead of generic <REDACTED> (default: False)
        specific_tokens=True,
    )
    ```
  </Tab>
</Tabs>

## What Gets Redacted

The plugin applies redaction to:

- **Trace input/output** - Messages sent to and from AI models
- **Span input/output** - Tool inputs and outputs
- **Interaction input/output** - Multi-step workflow data
- **Tool call arguments** - Function parameters
- **Error messages** - Stack traces and error strings that may contain sensitive data
- **Custom properties** - Any properties object attached to traces, spans, or interactions
- **Attachments** - Attachment content and filenames

## Example

**Before redaction:**
```
Hi, my email is john@example.com and my phone is (555) 123-4567.
My SSN is 123-45-6789.
```

**After redaction (default):**
```
Hi, my email is <REDACTED> and my phone is <REDACTED>.
My SSN is <REDACTED>.
```

**After redaction (with `specificTokens: true`):**
```
Hi, my email is <REDACTED_EMAIL> and my phone is <REDACTED_PHONE>.
My SSN is <REDACTED_SSN>.
```

## Name Redaction

When `redactNames` is enabled, the plugin uses multiple strategies to detect and redact names:

1. **Well-known names** - A built-in list of ~11,000 common first and last names
2. **Greeting context** - Names after greetings like "Hi John" or "Dear Sarah"
3. **Closing context** - Names before closings like "Thanks, John" or "Best regards, Sarah"
4. **Signature lines** - Short lines that appear to be signatures

**Example with name redaction:**
```
Hi John,

Thanks for reaching out about the project.

Best,
Sarah Smith
```

**After redaction (with `redactNames: true`):**
```
Hi <REDACTED_NAME>,

Thanks for reaching out about the project.

Best,
<REDACTED_NAME>
```

## Plugin Order

If you use multiple plugins, PII redaction should typically run **last** so other plugins (like OTEL) see the original data:

```typescript
const raindrop = new Raindrop({
  apiKey,
  plugins: [
    createOtelPlugin(), // Sees original data
    createPiiPlugin(),  // Redacts before transport
  ],
});
```

<Note>
When using the `redactPii: true` convenience option, the PII plugin is automatically added first in the plugin chain.
</Note>
